<!DOCTYPE html>
<html>
<head>
<title>Ember Realms</title>
<style>
body { margin:0; background:#111; color:white; font-family:Arial; overflow:hidden;}
#ui { position:absolute; top:10px; left:10px; z-index:10;}
canvas { background:#222; display:block;}
button { margin:2px;}
</style>
</head>
<body>

<div id="ui">
<div>Level: <span id="level">1</span></div>
<div>HP: <span id="hp">100</span></div>
<div>Continent: <span id="continent">1</span></div>
<div>Captured: <span id="captured">0</span></div>
<button onclick="saveGame()">Save</button>
<button onclick="loadGame()">Load</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const TILE = 32;
const MAP_SIZE = 600;
const CONTINENTS = 6;
const LEVEL_CAP = 300;

let currentContinent = 0;

let player = {
    x: 300,
    y: 300,
    level: 1,
    hp: 100,
    maxHp: 100,
    captured: []
};

let keys = {};

document.addEventListener("keydown", e => keys[e.key]=true);
document.addEventListener("keyup", e => keys[e.key]=false);

const TYPES = ["Fire","Water","Grass","Electric","Rock","Ice","Dark","Light","Steel","Psychic"];

function generatePokemon(id){
    return {
        id: id,
        name: "Mon"+id,
        type: TYPES[Math.floor(Math.random()*TYPES.length)],
        level: Math.floor(Math.random()*LEVEL_CAP)+1,
        hp: Math.floor(Math.random()*500)+100,
        attack: Math.floor(Math.random()*200)+50,
        defense: Math.floor(Math.random()*200)+50
    };
}

let POKEDEX = [];
for(let i=1;i<=5000;i++){
    POKEDEX.push(generatePokemon(i));
}

function randomEncounter(){
    if(Math.random()<0.01){
        let enemy = POKEDEX[Math.floor(Math.random()*POKEDEX.length)];
        battle(enemy);
    }
}

function battle(enemy){
    alert("A wild "+enemy.name+" appeared!");

    while(enemy.hp>0 && player.hp>0){
        enemy.hp -= player.level * 5;
        player.hp -= enemy.attack / 10;
    }

    if(player.hp<=0){
        alert("You fainted!");
        player.hp = player.maxHp;
        player.x=300;
        player.y=300;
    } else {
        alert("You defeated "+enemy.name+"!");
        if(Math.random()<0.3){
            player.captured.push(enemy);
            alert(enemy.name+" was captured!");
        }
        if(player.level<LEVEL_CAP){
            player.level++;
            player.maxHp += 5;
            player.hp = player.maxHp;
        }
    }
    updateUI();
}

function saveGame(){
    localStorage.setItem("emberSave", JSON.stringify(player));
    alert("Game Saved");
}

function loadGame(){
    let data = localStorage.getItem("emberSave");
    if(data){
        player = JSON.parse(data);
        updateUI();
        alert("Game Loaded");
    }
}

function updateUI(){
    document.getElementById("level").textContent = player.level;
    document.getElementById("hp").textContent = Math.floor(player.hp);
    document.getElementById("continent").textContent = currentContinent+1;
    document.getElementById("captured").textContent = player.captured.length;
}

function drawTile(x,y){
    let noise = Math.random();
    if(noise<0.7) ctx.fillStyle="#2ecc71";
    else if(noise<0.85) ctx.fillStyle="#3498db";
    else ctx.fillStyle="#95a5a6";
    ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
}

function drawWorld(){
    for(let x=0;x<canvas.width/TILE;x++){
        for(let y=0;y<canvas.height/TILE;y++){
            drawTile(x,y);
        }
    }
}

function drawPlayer(){
    ctx.fillStyle="red";
    ctx.fillRect(player.x,player.y,TILE,TILE);
}

function movePlayer(){
    if(keys["ArrowUp"]) player.y-=4;
    if(keys["ArrowDown"]) player.y+=4;
    if(keys["ArrowLeft"]) player.x-=4;
    if(keys["ArrowRight"]) player.x+=4;

    if(player.x<0){ currentContinent=(currentContinent+1)%CONTINENTS; player.x=canvas.width-TILE;}
    if(player.x>canvas.width-TILE){ currentContinent=(currentContinent+1)%CONTINENTS; player.x=0;}

    randomEncounter();
}

function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawWorld();
    movePlayer();
    drawPlayer();
    requestAnimationFrame(gameLoop);
}

updateUI();
gameLoop();
</script>

</body>
</html>
 
